<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="reservation">
  	<select id="selectReservation" resultType="caravan">
		select distinct
		caravan_no as caravanNo,
		caravan_name as caravanName,
		caravan_area as caravanArea,
		caravan_people as caravanPeople,
		caravan_max_people as caravanMaxPeople,
		caravan_plus_cost as caravanPlusCost,
		caravan_cost as caravanCost,
		caravan_info as caravanInfo,
		caravan_main_img as caravanMainImg,
		caravan_img as caravanImg 
		from caravan where caravan_no not in
		(select distinct caravan_no from reservation a where 
		<foreach item="arr" collection="array" separator="or">
				reservation_date like '%'||#{arr}||'%'
		</foreach>
		) order by caravan_no
	</select>
	<insert id="insertReservation" parameterType="map">
		insert into reservation values(#{caravanNo},#{reservationDateString})
	</insert>
</mapper>
